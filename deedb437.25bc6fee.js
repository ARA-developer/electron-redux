(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{69:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return p}));var r=n(2),a=n(6),o=(n(0),n(74)),i={id:"version-1-x",title:"Version 1.x documentation",description:"Version 1.x > Legacy documentation",hide_title:!0},c={unversionedId:"v1/version-1-x",id:"v1/version-1-x",isDocsHomePage:!1,title:"Version 1.x documentation",description:"Version 1.x > Legacy documentation",source:"@site/docs/v1/version-1-x.md",slug:"/v1/version-1-x",permalink:"/electron-redux/v1/version-1-x",editUrl:"https://github.com/klarna/electron-redux/edit/master/docs/v1/version-1-x.md",version:"current",sidebar:"sidebar",previous:{title:"API Reference",permalink:"/electron-redux/api/api-reference"},next:{title:"Migration guide - v1 to v2",permalink:"/electron-redux/v1/migrating-from-v1-to-v2"}},s=[{value:"Motivation",id:"motivation",children:[{value:"The solution",id:"the-solution",children:[]}]},{value:"Install",id:"install",children:[]},{value:"Actions",id:"actions",children:[{value:"Local actions (renderer process)",id:"local-actions-renderer-process",children:[]},{value:"Aliased actions (main process)",id:"aliased-actions-main-process",children:[]},{value:"Blacklisted actions",id:"blacklisted-actions",children:[]}]},{value:"F.A.Q",id:"faq",children:[{value:"<code>electron-redux</code> crashes with electron 10.x",id:"electron-redux-crashes-with-electron-10x",children:[]}]}],l={rightToc:s};function p(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h1",{id:"electron-redux-v1x"},"electron-redux v1.x"),Object(o.b)("p",null,"This is documentation (as in README file) that has been shipped with v1 - since it might be still useful for someone to debug existing applications, entire content is shared here."),Object(o.b)("p",null,"Version 1.x is no longer maintainer, and we encurage you to try out the all new shiny v2! Please check our ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/v1/migrating-from-v1-to-v2"}),"migration guide")," to understand how you can upgrade your app to the latest!"),Object(o.b)("h2",{id:"motivation"},"Motivation"),Object(o.b)("p",null,"Using redux with electron poses a couple of problems. Processes (",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/electron/electron/blob/master/docs/tutorial/quick-start.md#main-process"}),"main")," and ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/electron/electron/blob/master/docs/tutorial/quick-start.md#renderer-process"}),"renderer"),") are completely isolated, and the only mode of communication is ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/electron/electron/blob/master/docs/api/ipc-main.md"}),"IPC"),"."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Where do you keep the state?"),Object(o.b)("li",{parentName:"ul"},"How do you keep the state in sync across processes?")),Object(o.b)("h3",{id:"the-solution"},"The solution"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"electron-redux")," offers an easy to use solution. The redux store on the main process becomes the single source of truth, and stores in the renderer processes become mere proxies. See ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"#under-the-hood"}),"under the hood"),"."),Object(o.b)("p",null,Object(o.b)("img",Object(r.a)({parentName:"p"},{src:"https://cloud.githubusercontent.com/assets/307162/20675737/385ce59e-b585-11e6-947e-3867e77c783d.png",alt:"electron-redux basic"}))),Object(o.b)("h2",{id:"install"},"Install"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{}),"npm install --save electron-redux\n")),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"electron-redux")," comes as redux middleware that is really easy to apply:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"// in the main store\nimport { forwardToRenderer, triggerAlias, replayActionMain } from 'electron-redux'\n\nconst todoApp = combineReducers(reducers)\n\nconst store = createStore(\n    todoApp,\n    initialState, // optional\n    applyMiddleware(\n        triggerAlias, // optional, see below\n        ...otherMiddleware,\n        forwardToRenderer // IMPORTANT! This goes last\n    )\n)\n\nreplayActionMain(store)\n")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"// in the renderer store\nimport { forwardToMain, replayActionRenderer, getInitialStateRenderer } from 'electron-redux'\n\nconst todoApp = combineReducers(reducers)\nconst initialState = getInitialStateRenderer()\n\nconst store = createStore(\n    todoApp,\n    initialState,\n    applyMiddleware(\n        forwardToMain, // IMPORTANT! This goes first\n        ...otherMiddleware\n    )\n)\n\nreplayActionRenderer(store)\n")),Object(o.b)("p",null,"Check out ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/hardchor/timesheets/blob/4991fd472dbb12b0c6e6806c6a01ea3385ab5979/app/shared/store/configureStore.js"}),"timesheets")," for a more advanced example."),Object(o.b)("p",null,"And that's it! You are now ready to fire actions without having to worry about synchronising your state between processes."),Object(o.b)("h2",{id:"actions"},"Actions"),Object(o.b)("p",null,"Actions fired ",Object(o.b)("strong",{parentName:"p"},"MUST")," be ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/acdlite/flux-standard-action#example"}),"FSA"),"-compliant, i.e. have a ",Object(o.b)("inlineCode",{parentName:"p"},"type")," and ",Object(o.b)("inlineCode",{parentName:"p"},"payload")," property. Any actions not passing this test will be ignored and simply passed through to the next middleware."),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"NB: ",Object(o.b)("inlineCode",{parentName:"p"},"redux-thunk")," is not FSA-compliant out of the box, but can still produce compatible actions once the async action fires.")),Object(o.b)("p",null,"Furthermore, actions (and that includes ",Object(o.b)("inlineCode",{parentName:"p"},"payload"),"s) ",Object(o.b)("strong",{parentName:"p"},"MUST")," be (de-)serialisable, i.e. either POJOs (simple ",Object(o.b)("inlineCode",{parentName:"p"},"object"),"s - that excludes native JavaScript or DOM objects like ",Object(o.b)("inlineCode",{parentName:"p"},"FileList"),", ",Object(o.b)("inlineCode",{parentName:"p"},"Map"),", etc.), ",Object(o.b)("inlineCode",{parentName:"p"},"array"),"s, or primitives. For workarounds, check out ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"#aliased-actions-main-process"}),"aliased actions")),Object(o.b)("h3",{id:"local-actions-renderer-process"},"Local actions (renderer process)"),Object(o.b)("p",null,"By default, all actions are being broadcast from the main store to the renderer processes. However, some state should only live in the renderer (e.g. ",Object(o.b)("inlineCode",{parentName:"p"},"isPanelOpen"),"). ",Object(o.b)("inlineCode",{parentName:"p"},"electron-redux")," introduces the concept of action scopes."),Object(o.b)("p",null,"To stop an action from propagating from renderer to main store, simply set the scope to ",Object(o.b)("inlineCode",{parentName:"p"},"local"),":"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"function myLocalActionCreator() {\n    return {\n        type: 'MY_ACTION',\n        payload: 123,\n        meta: {\n            scope: 'local',\n        },\n    }\n}\n")),Object(o.b)("h3",{id:"aliased-actions-main-process"},"Aliased actions (main process)"),Object(o.b)("p",null,"Most actions will originate from the renderer side, but not all should be executed there as well. A great example is fetching of data from an external source, e.g. using ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/acdlite/redux-promise"}),"promise middleware"),", which should only ever be executed once (i.e. in the main process). This can be achieved using the ",Object(o.b)("inlineCode",{parentName:"p"},"triggerAlias")," middleware mentioned ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"#install"}),"above"),"."),Object(o.b)("p",null,"Using the ",Object(o.b)("inlineCode",{parentName:"p"},"createAliasedAction")," helper, you can quite easily create actions that are are only being executed in the main process, and the result of which is being broadcast to the renderer processes."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"import { createAliasedAction } from 'electron-redux'\n\nexport const importGithubProjects = createAliasedAction(\n    'IMPORT_GITHUB_PROJECTS', // unique identifier\n    (accessToken, repoFullName) => ({\n        type: 'IMPORT_GITHUB_PROJECTS',\n        payload: importProjects(accessToken, repoFullName),\n    })\n)\n")),Object(o.b)("p",null,"Check out ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/hardchor/timesheets/blob/4ccaf08dee4e1a02850b5bf36e37c537fef7d710/app/shared/actions/github.js"}),"timesheets")," for more examples."),Object(o.b)("h3",{id:"blacklisted-actions"},"Blacklisted actions"),Object(o.b)("p",null,"By default actions of certain type (e.g. starting with '@@') are not propagated to the main thread. You can change this behaviour by using ",Object(o.b)("inlineCode",{parentName:"p"},"forwardToMainWithParams")," function."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"// in the renderer store\nimport {\n    forwardToMainWithParams,\n    replayActionRenderer,\n    getInitialStateRenderer,\n} from 'electron-redux'\n\nconst todoApp = combineReducers(reducers)\nconst initialState = getInitialStateRenderer()\n\nconst store = createStore(\n    todoApp,\n    initialState,\n    applyMiddleware(\n        forwardToMainWithParams(), // IMPORTANT! This goes first\n        ...otherMiddleware\n    )\n)\n\nreplayActionRenderer(store)\n")),Object(o.b)("p",null,"You can specify patterns for actions that should not be propagated to the main thread."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"forwardToMainWithParams({\n    blacklist: [/^@@/, /^redux-form/],\n})\n")),Object(o.b)("h2",{id:"faq"},"F.A.Q"),Object(o.b)("h3",{id:"electron-redux-crashes-with-electron-10x"},Object(o.b)("inlineCode",{parentName:"h3"},"electron-redux")," crashes with electron 10.x"),Object(o.b)("p",null,"As of Electron 10, the ",Object(o.b)("inlineCode",{parentName:"p"},"remote")," module is removed by default."),Object(o.b)("p",null,"We can get it back by adding ",Object(o.b)("inlineCode",{parentName:"p"},"enableRemoteModule=true")," to the ",Object(o.b)("inlineCode",{parentName:"p"},"webPreferences"),":"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"const w = new BrowserWindow({\n    webPreferences: {\n        enableRemoteModule: true,\n    },\n})\n")))}p.isMDXComponent=!0},74:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=a.a.createContext({}),p=function(e){var t=a.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},b=function(e){var t=p(e.components);return a.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},u=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),b=p(n),u=r,m=b["".concat(i,".").concat(u)]||b[u]||d[u]||o;return n?a.a.createElement(m,c(c({ref:t},l),{},{components:n})):a.a.createElement(m,c({ref:t},l))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,i[1]=c;for(var l=2;l<o;l++)i[l]=n[l];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);